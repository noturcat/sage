@use 'sass:map';
@use 'sass:math';

// Breakpoints
$breakpoints: (
	small: 480px,
	medium: 720px,
	large: 960px,
	wide: 1200px,
);

@mixin flex($columns, $gap, $rowgap: false) {
	display: flex;
	flex-wrap: wrap;

	@if ($rowgap) {
		row-gap: $rowgap;
		column-gap: $gap;
	} @else {
		gap: $gap;
	}

	& > * {
		width: calc((100% - (#{$gap} * (#{$columns} - 1))) / #{$columns});
	}
}

@mixin breakpoint($breakpoint: md, $key: min, $orientation: false) {
	@if ($orientation) {
		@media (#{$key}-width: map.get($breakpoints, $breakpoint)) and (orientation : $orientation) {
			@content;
		}
	} @else {
		@media (#{$key}-width: map.get($breakpoints, $breakpoint)) {
			@content;
		}
	}
}

@mixin dropshadow {
	box-shadow:
		0px 10px 10px 0px rgba(0, 0, 0, 0.1),
		0px 20px 50px 0px rgba(0, 0, 0, 0.05);
}

@mixin transition {
	transition: all 0.3s ease;
}

@mixin image-container($max-width, $padding-bottom) {
	position: relative;
	max-width: $max-width !important;
	width: 100%;
	padding-bottom: $padding-bottom;
	overflow: hidden;
}

@mixin input-base {
	display: flex;
	width: 100%;
	min-width: 0;
	background-color: transparent;
	font-size: 1rem;
	line-height: 1.5;
	transition:
		color 0.15s ease-in-out,
		box-shadow 0.15s ease-in-out;
	outline: none;

	&::placeholder {
		color: var(--jh-gray-01);
	}
	&::selection {
		background-color: var(--jh-green-01);
		color: var(--jh-white-01);
	}

	&::file-selector-button {
		display: inline-flex;
		height: 1.75rem;
		border: 0;
		background-color: transparent;
		color: var(--black);
		font-size: 0.88rem;
		font-weight: 500;
	}

	&:focus-visible {
		border-color: var(--jh-gray-02);
		box-shadow: 0 0 0 3px rgba(var(--jh-gray-02), 0.5);
	}

	&[aria-invalid='true'] {
		border-color: var(--jh-red-01);
		box-shadow: 0 0 0 3px rgba(var(--jh-red-01), 0.2);
	}

	&:disabled {
		pointer-events: none;
		cursor: not-allowed;
		opacity: 0.5;
	}

	@media (min-width: 768px) {
		font-size: 0.88rem;
	}

	&::-webkit-search-cancel-button {
		-webkit-appearance: none;
		appearance: none;
		display: none;
	}
}

@mixin radio-input($size: 20px, $checked-color: var(--jh-green-01-rgb)) {
	appearance: none;
	-webkit-appearance: none;
	width: $size;
	height: $size;
	border: 2px solid var(--jh-gray-04);
	border-radius: 50%;
	background-color: var(--white);
	cursor: pointer;
	position: relative;
	transition: all 0.2s ease-in-out;
	flex-shrink: 0;

	&:hover {
		border-color: var(--jh-green-01);
	}

	&:focus {
		outline: none;
		border-color: var(--jh-gray-02);
		box-shadow: 0 0 0 3px rgba(var(--jh-gray-02), 0.2);
	}

	&:checked {
		border-color: var(--jh-gray-03);
		background-color: var(--jh-white-01);

		&::before {
			content: '';
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: math.div($size, 2);
			height: math.div($size, 2);
			border-radius: 50%;
			background-color: $checked-color;
		}

		&:hover::before {
			background-color: rgba(var($checked-color), 0.8);
		}

		&:focus {
			border-color: var(--jh-gray-02);
		}
	}

	&:disabled {
		cursor: not-allowed;
		opacity: 0.5;
		border-color: var(--jh-gray-02);

		&:checked {
			&::before {
				background-color: var(--jh-gray-02);
			}
		}
	}
}

@mixin checkbox-input {
	appearance: none;
	-webkit-appearance: none;
	width: 20px;
	height: 20px;
	border: 2px solid var(--jh-gray-03);
	border-radius: 4px;
	background-color: var(--jh-white-01);
	cursor: pointer;
	position: relative;
	transition: all 0.2s ease-in-out;
	flex-shrink: 0;

	&:hover {
		border-color: var(--jh-green-01);
	}

	&:focus {
		outline: none;
		border-color: var(--jh-green-01);
		box-shadow: 0 0 0 3px rgba(var(--jh-green-01), 0.2);
	}

	&:checked {
		border-color: var(--jh-green-01);
		background-color: var(--jh-green-01);

		&::before {
			content: '';
			position: absolute;
			top: 2px;
			left: 6px;
			width: 6px;
			height: 10px;
			border: solid var(--jh-white-01);
			border-width: 0 2px 2px 0;
			transform: rotate(45deg);
		}
	}

	&:disabled {
		cursor: not-allowed;
		opacity: 0.5;
		border-color: var(--jh-gray-02);

		&:checked {
			background-color: var(--jh-gray-02);
			border-color: var(--jh-gray-02);
		}
	}
}

@mixin range-input {
	appearance: none;
	-webkit-appearance: none;
	width: 100%;
	height: 6px;
	border-radius: 3px;
	background: var(--jh-gray-04);
	outline: none;
	cursor: pointer;

	&::-webkit-slider-thumb {
		appearance: none;
		-webkit-appearance: none;
		width: 20px;
		height: 20px;
		border-radius: 50%;
		background: var(--jh-green-01);
		cursor: pointer;
		border: 2px solid var(--jh-white-01);
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		transition: all 0.2s ease-in-out;

		&:hover {
			transform: scale(1.1);
		}
	}

	&::-moz-range-thumb {
		width: 20px;
		height: 20px;
		border-radius: 50%;
		background: var(--jh-green-01);
		cursor: pointer;
		border: 2px solid var(--jh-white-01);
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		transition: all 0.2s ease-in-out;

		&:hover {
			transform: scale(1.1);
		}
	}
}

@mixin file-input {
	&[type='file'] {
		border: 2px dashed var(--jh-gray-03);
		border-radius: 0.5em;
		padding: 1.31em 2.31em;
		text-align: center;
		background-color: var(--jh-gray-05);
		cursor: pointer;
		transition: all 0.2s ease-in-out;

		&:hover {
			border-color: var(--jh-gray-02);
			background-color: rgba(var(--jh-gray-05-rgb), 0.8);
		}

		&:focus {
			outline: none;
			border-color: var(--jh-gray-02);
			box-shadow: 0 0 0 3px rgba(var(--jh-gray-02-rgb), 0.8);
		}
	}
}

// Button Reset Mixin
@mixin reset-button {
	appearance: none;
	-webkit-appearance: none;
	background: none;
	border: none;
	padding: 0;
	margin: 0;
	font: inherit;
	color: inherit;
	text-decoration: none;
	cursor: pointer;
	outline: none;

	&:focus {
		outline: none;
	}

	&:disabled {
		cursor: not-allowed;
		opacity: 0.6;
	}
}

// Icon Mixin
@mixin icon($url, $size: 16px) {
	width: $size;
	height: $size;
	display: inline-block;

	// Fallback for browsers without mask support
	background-image: url($url);
	background-repeat: no-repeat;
	background-position: center;
	background-size: contain;

	// Modern approach with masks
	background-color: currentColor;
	-webkit-mask-image: url($url);
	-webkit-mask-repeat: no-repeat;
	-webkit-mask-position: center;
	-webkit-mask-size: contain;
	mask-image: url($url);
	mask-repeat: no-repeat;
	mask-position: center;
	mask-size: contain;

	// Hide fallback when mask is supported
	@supports (mask-image: url($url)) {
		background-image: none;
	}
}
